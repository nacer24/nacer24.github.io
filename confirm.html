<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Confirm Subscription</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: Arial; text-align: center; padding: 40px; }
  </style>
</head>
<body>
  <h2>Confirming your subscription...</h2>
  <p>Please wait, you will be redirected to your eBook.</p>

  <script>
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxWmqcNuJf22G4JrygLMsaU-MVCUeZQEG_gzcu7YZMdSvwyuHIXVapjShbZ0dPeNP4qUA/exec";
    const EBOOK_URL = "https://nacer24.github.io/ebook.pdf";

    const urlParams = new URLSearchParams(window.location.search);
    const email = urlParams.get("email");

    if (email) {
      fetch(WEB_APP_URL, {
        method: "POST",
        body: new URLSearchParams({ action: "confirm", email: email })
      })
      .then(() => {
        window.location.href = EBOOK_URL;
      })
      .catch(() => {
        document.body.innerHTML = "<h3>Error confirming subscription.</h3>";
      });
    } else {
      document.body.innerHTML = "<h3>Invalid confirmation link.</h3>";
    }
  </script>
</body>
</html>
